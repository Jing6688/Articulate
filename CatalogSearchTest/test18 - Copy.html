<!DOCTYPE html>
<html>
<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>

<body id="opac-main">
<div class="container-fluid">
    <div class="row">
        <div class="col">
            <div id="opac-main-search" class="mastheadsearch">
                <!-- Tab navigation -->
                <ul class="nav nav-tabs" id="searchTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="discovery-tab" data-bs-toggle="tab" data-bs-target="#discovery" type="button" role="tab" aria-controls="discovery" aria-selected="true">Discovery Search</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="catalog-tab" data-bs-toggle="tab" data-bs-target="#catalog" type="button" role="tab" aria-controls="catalog" aria-selected="false">Catalogue Search</button>
                    </li>
                </ul>

                <!-- Tab content -->
                <div class="tab-content" id="searchTabContent">
                    <!-- First tab (Discovery Search) -->
                    <div class="tab-pane fade show active" id="discovery" role="tabpanel" aria-labelledby="discovery-tab">
                        <form name="searchform" method="get" action="/cgi-bin/koha/opac-search.pl" id="searchform">
                            <div class="row gx-2 p-3">
                                <div class="col-sm-auto order-2 order-sm-2 dropdown-container">
                                    <label for="masthead_search" class="visually-hidden">Search the catalogue by:</label>
                                    <select name="idx" id="masthead_search" class="form-select">
                                        <option value="" data-placeholder="Search the catalogue by keyword">Library catalogue</option>
                                        <option value="ti" data-placeholder="Search the catalogue by title">Title</option>
                                        <option value="au" data-placeholder="Search the catalogue by author">Author</option>
                                        <option value="su" data-placeholder="Search the catalogue by subject">Subject</option>
                                        <option value="nb" data-placeholder="Search the catalogue by ISBN">ISBN</option>
                                        <option value="ns" data-placeholder="Search the catalogue by ISSN">ISSN</option>
                                        <option value="se" data-placeholder="Search the catalogue by series">Series</option>
                                        <option value="callnum" data-placeholder="Search the catalogue by call number">Call number</option>
                                    </select>
                                </div>
                                <div class="col order-4 order-sm-3">
                                    <label for="translControl1" class="visually-hidden">Search books, eBooks, and articles</label>
                                    <div class="input-wrapper">
                                        <input type="text" class="transl1 form-control" id="translControl1" name="q" value="" placeholder="Search books, eBooks, and articles" />
                                    </div>
                                    <span id="translControl"></span>
                                </div>
                                <div class="order-5 col-sm-auto">
                                    <button type="submit" id="searchsubmit" class="btn btn-primary search-btn" title="Search" aria-label="Search">
                                        <i class="fa fa-search search-icon" aria-hidden="true"></i>
                                    </button>
                                </div>
                            </div>
                            <input type="hidden" name="weight_search" value="1">
                        </form>
                    </div>

                    <!-- Second tab (Catalogue Search) -->
                    <div class="tab-pane fade" id="catalog" role="tabpanel" aria-labelledby="catalog-tab">
                        <form name="searchform" method="get" action="/cgi-bin/koha/opac-search.pl" id="searchform">
                            <div class="row gx-2 p-3">
                                <div class="col-sm-auto order-2 order-sm-2 dropdown-container">
                                    <label for="masthead_search" class="visually-hidden">Search the catalogue by:</label>
                                    <select name="idx" id="masthead_search" class="form-select">
                                        <option value="" data-placeholder="Search the catalogue by keyword">Library catalogue</option>
                                        <option value="ti" data-placeholder="Search the catalogue by title">Title</option>
                                        <option value="au" data-placeholder="Search the catalogue by author">Author</option>
                                        <option value="su" data-placeholder="Search the catalogue by subject">Subject</option>
                                        <option value="nb" data-placeholder="Search the catalogue by ISBN">ISBN</option>
                                        <option value="ns" data-placeholder="Search the catalogue by ISSN">ISSN</option>
                                        <option value="se" data-placeholder="Search the catalogue by series">Series</option>
                                        <option value="callnum" data-placeholder="Search the catalogue by call number">Call number</option>
                                    </select>
                                </div>
                                <div class="col order-4 order-sm-3">
                                    <label for="translControl1" class="visually-hidden">Search the catalogue by keyword</label>
                                    <div class="input-wrapper">
                                        <input type="text" class="transl1 form-control" id="translControl1" name="q" value="" placeholder="Search the catalogue by keyword" />
                                    </div>
                                    <span id="translControl"></span>
                                </div>
                                <div class="order-5 col-sm-auto">
                                    <button type="submit" id="searchsubmit" class="btn btn-primary search-btn" title="Search" aria-label="Search">
                                        <i class="fa fa-search search-icon" aria-hidden="true"></i>
                                    </button>
                                </div>
                            </div>
                            <input type="hidden" name="weight_search" value="1">
                        </form>
                    </div>
                </div>

                <!-- Links inside the search box -->
                <div class="row p-1">
                    <ul class="nav justify-content-center" id="moresearches">
                        <li class="nav-item">
                            <a href="/cgi-bin/koha/opac-search.pl">Advanced search</a>
                        </li>
                        <li class="nav-item separator"> | </li>
                        <li class="nav-item">
                            <a href="/cgi-bin/koha/opac-authorities-home.pl">Authority search</a>
                        </li>
                        <li class="nav-item separator"> | </li>
                        <li class="nav-item">
                            <a id="library_page" href="/cgi-bin/koha/opac-library.pl">
                                <span>Libraries</span>
                            </a>
                        </li>
                        <li class="nav-item separator"> | </li>
                        <li class="nav-item">
                            <a href="https://kinderlibrary.libguides.com/using-catalogue">Catalogue help</a>
                        </li>
                    </ul>
                </div>
            </div><!-- /#opac-main-search -->
        </div><!-- /.col -->
    </div><!-- /.row -->
</div><!-- /.container-fluid -->

<script>
    // JavaScript for loading new orders
    if($('#new_orders').length) {
        $.get("/files/kinder/books.html", function(data){
            document.getElementById("new_orders").innerHTML = data;
        });
    }

    // EDS settings
    var edsSettings = {
        "EDS Dropdown Text": "Discovery",
        "EDS URL": "https://search.ebscohost.com/login.aspx?authtype=ip,guest&custid=s8207384&groupid=main&profile=eds20",
        "EDS Default": true
    };

    // Add the "Discovery" option to the dropdown and handle form submission
    var selectE, selectL = "beforeEnd";
    if (edsSettings["EDS Default"]) {
        selectL = "afterBegin";
    }
    if (document.querySelector("#searchform")) {
        selectE = document.querySelector("#searchform select[name='idx']");
        if (selectE) {
            selectE.insertAdjacentHTML(selectL, '<option value="_eds">' + edsSettings["EDS Dropdown Text"] + '</option>');
            if (document.querySelector("body#opac-main")) {
                selectE.value = "_eds"; // Set default to Discovery
            }
        }
        document.querySelector("#searchform").onsubmit = function(e) {
            // Check if the "Discovery Search" tab is active to determine the search type
            var isDiscoveryTabActive = document.querySelector("#discovery-tab").classList.contains("active");
            if (isDiscoveryTabActive || (selectE && selectE.value === "_eds")) {
                e.preventDefault();
                window.location = edsSettings["EDS URL"] + "&direct=true&bquery=" + encodeURIComponent(document.querySelector("#searchform input[name='q']").value);
            }
        };
    }

    // Handle tab switching
    document.getElementById("discovery-tab").addEventListener("click", function() {
        // Hide the dropdown for Discovery Search tab
        var dropdownContainers = document.querySelectorAll(".dropdown-container");
        dropdownContainers.forEach(function(container) {
            container.style.display = "none";
        });
        // Update placeholder text for Discovery Search
        document.querySelector("#translControl1").placeholder = "Search books, eBooks, and articles";
    });

    document.getElementById("catalog-tab").addEventListener("click", function() {
        // Show the dropdown for Catalogue Search tab
        var dropdownContainers = document.querySelectorAll(".dropdown-container");
        dropdownContainers.forEach(function(container) {
            container.style.display = "block";
        });
        // Update placeholder text for Catalogue Search
        document.querySelector("#translControl1").placeholder = "Search the catalogue by keyword";
        // Set dropdown to default value if it exists
        if (selectE) {
            selectE.value = "";
        }
    });

    // Initialize the dropdown visibility based on the active tab
    window.addEventListener("load", function() {
        if (document.querySelector("#discovery-tab").classList.contains("active")) {
            var dropdownContainers = document.querySelectorAll(".dropdown-container");
            dropdownContainers.forEach(function(container) {
                container.style.display = "none";
            });
        } else {
            var dropdownContainers = document.querySelectorAll(".dropdown-container");
            dropdownContainers.forEach(function(container) {
                container.style.display = "block";
            });
        }
    });
</script>

<style>
.input-wrapper {
    position: relative;
    display: inline-block;
    width: 100%;
}

.input-wrapper input.form-control {
    border-radius: 0.375rem;
}

.input-wrapper input.form-control:focus {
    outline: none !important;
    box-shadow: none !important;
    border-color: #96342d;
}

.input-wrapper:has(input.form-control:focus)::after {
    content: '';
    position: absolute;
    top: -0.2rem;
    left: -0.2rem;
    right: -0.2rem;
    bottom: -0.2rem;
    border: 2px solid rgba(150, 52, 45, 0.5);
    border-radius: 0.5rem;
    z-index: 1;
}

/* Fallback for older browsers without :has() support */
/*
.input-wrapper {
    position: relative;
    display: inline-block;
    width: 100%;
}

.input-wrapper input.form-control {
    border-radius: 0.375rem;
}

.input-wrapper input.form-control:focus {
    outline: none !important;
    box-shadow: none !important;
    border-color: #96342d;
}

.input-wrapper::after {
    content: '';
    position: absolute;
    top: -0.2rem;
    left: -0.2rem;
    right: -0.2rem;
    bottom: -0.2rem;
    border: 2px solid transparent;
    border-radius: 0.5rem;
    z-index: 1;
    transition: border-color 0.2s;
}

.input-wrapper:focus-within::after {
    border-color: rgba(150, 52, 45, 0.5);
}
*/

body {
    background-color: #fff;
    font-size: 16px;
    line-height: 24px;
    font-family: 'Open Sans',"Helvetica Neue",Helvetica,Arial,sans-serif;
    color: #96342d;
}

#opac-main-search {
    margin-left: 10%;
    margin-right: 10%;
    max-width: 100%;
    background-color: #96342d;
}

#opac-main-search label {
    color: #FFF;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
}

/* Search button styling */
.search-btn {
    position: relative;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: #FFF;
    border: none;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
}

.search-icon {
    color: #FFF;
    font-size: 18px;
    position: relative;
    -webkit-text-stroke: 1px #FFF;
    text-shadow: 0 0 2px #FFF;
}

.search-btn .search-icon::before {
    content: "\f002"; /* Font Awesome magnifying glass */
    font-family: "Font Awesome 5 Free";
    font-weight: 900;
}

/* Placeholder text styling */
.form-control::placeholder {
    color: #CCCCCC;
    opacity: 0.7;
}

/* Tab content styling */
.tab-content {
    background-color: #fff;
    margin-left: 20%;
    margin-right: 20%;
}

/* Links styling */
#moresearches {
    margin-bottom: 10;
    width: 100%;
    padding: 0 20px;
}

#moresearches .nav-item {
    text-align: center;
    margin: 0 10px;
}

#moresearches .separator {
    color: #FFF;
    margin: 0 0 5px 10;
}

#moresearches a {
    color: #FFF;
    font-size: 16px;
    padding: 5px 10px;
}

#moresearches a:hover {
    color: #FFF;
}

/* Tab styling */
.nav-tabs {
    border-bottom: 1px solid #FFF;
    margin-left: 20%;
    margin-right: 20%;
}

.nav-tabs .nav-link {
    margin-top: 20px;
    color: #FFF;
    border: 1px solid transparent;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
}

.nav-tabs .nav-link:hover {
    border-color: #FFF;
}

.nav-tabs .nav-link.active {
    color: #96342d;
    background-color: #fff;
    border-bottom: 1px solid #999999;
}

/* Rest of your existing styles */
legend, h4, h3, h2, h1 {
    color: #d9dbb9;
}

/* Button styling for search buttons */
#opac-main-search .btn.btn-primary {
    background-color: #96342d;
    background-image: none;
    text-shadow: none;
    box-shadow: none;
    border: none;
}

#opac-main-search .btn.btn-primary:hover,
#opac-main-search .btn.btn-primary:active {
    background-color: #96342d;
    background-image: none;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
}

/* Dropdown container styling */
.dropdown-container {
    display: none;
}
</style>
</body>
</html>